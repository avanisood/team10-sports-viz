<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complexity Heatmap - D3.js</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #2C3E50;
        }
        .cell {
            cursor: pointer;
        }
        .cell:hover {
            stroke: black !important;
            stroke-width: 3px !important;
        }
        .axis path,
        .axis line {
            fill: none;
            stroke: #999;
            shape-rendering: crispEdges;
        }
        .tooltip {
            position: absolute;
            padding: 10px;
            background: rgba(0,0,0,0.8);
            color: white;
            border-radius: 5px;
            pointer-events: none;
            font-size: 12px;
            opacity: 0;
        }
        .legend-label {
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Complexity Heatmap: Which Sports Trigger Long Discussions?</h1>
        <p style="text-align: center; color: #7f8c8d; margin-bottom: 20px;">
            Distribution of 520 prompts categorized by word count. Darker colors indicate higher frequency.
        </p>
        <div id="chart"></div>
    </div>
    <div class="tooltip" id="tooltip"></div>
    
    <script>
        const margin = {top: 100, right: 100, bottom: 120, left: 150};
        const width = 1200 - margin.left - margin.right;
        const height = 600 - margin.top - margin.bottom;
        
        const svg = d3.select('#chart')
            .append('svg')
            .attr('width', width + margin.left + margin.right)
            .attr('height', height + margin.top + margin.bottom)
            .append('g')
            .attr('transform', `translate(${margin.left},${margin.top})`);
        
        const tooltip = d3.select('#tooltip');
        
        // Data
        const heatmapData = [
            {sport: 'basketball', length: 'Short (<10 words)', count: 35},
            {sport: 'basketball', length: 'Medium (10-30)', count: 40},
            {sport: 'basketball', length: 'Long (30-60)', count: 5},
            {sport: 'basketball', length: 'Essay (60+)', count: 47},
            {sport: 'chess', length: 'Short (<10 words)', count: 9},
            {sport: 'chess', length: 'Medium (10-30)', count: 18},
            {sport: 'chess', length: 'Long (30-60)', count: 0},
            {sport: 'chess', length: 'Essay (60+)', count: 14},
            {sport: 'cricket', length: 'Short (<10 words)', count: 15},
            {sport: 'cricket', length: 'Medium (10-30)', count: 27},
            {sport: 'cricket', length: 'Long (30-60)', count: 2},
            {sport: 'cricket', length: 'Essay (60+)', count: 51},
            {sport: 'football', length: 'Short (<10 words)', count: 36},
            {sport: 'football', length: 'Medium (10-30)', count: 65},
            {sport: 'football', length: 'Long (30-60)', count: 14},
            {sport: 'football', length: 'Essay (60+)', count: 142}
        ];
        
        const sports = ['basketball', 'chess', 'cricket', 'football'];
        const lengths = ['Short (<10 words)', 'Medium (10-30)', 'Long (30-60)', 'Essay (60+)'];
        
        // Scales
        const xScale = d3.scaleBand()
            .domain(lengths)
            .range([0, width])
            .padding(0.05);
        
        const yScale = d3.scaleBand()
            .domain(sports)
            .range([0, height])
            .padding(0.05);
        
        const colorScale = d3.scaleSequential(d3.interpolateYlOrRd)
            .domain([0, d3.max(heatmapData, d => d.count)]);
        
        // Draw cells
        svg.selectAll('.cell')
            .data(heatmapData)
            .enter().append('rect')
            .attr('class', 'cell')
            .attr('x', d => xScale(d.length))
            .attr('y', d => yScale(d.sport))
            .attr('width', xScale.bandwidth())
            .attr('height', yScale.bandwidth())
            .style('fill', d => colorScale(d.count))
            .style('stroke', 'white')
            .style('stroke-width', 3)
            .on('mouseover', function(event, d) {
                tooltip.style('opacity', 1)
                    .html(`<strong>${d.sport}</strong><br/>${d.length}<br/>Count: ${d.count}`);
            })
            .on('mousemove', function(event) {
                tooltip.style('left', (event.pageX + 10) + 'px')
                    .style('top', (event.pageY - 10) + 'px');
            })
            .on('mouseout', function() {
                tooltip.style('opacity', 0);
            });
        
        // Add text labels
        svg.selectAll('.label')
            .data(heatmapData)
            .enter().append('text')
            .attr('x', d => xScale(d.length) + xScale.bandwidth() / 2)
            .attr('y', d => yScale(d.sport) + yScale.bandwidth() / 2)
            .attr('dy', '0.35em')
            .text(d => d.count)
            .style('text-anchor', 'middle')
            .style('font-size', '16px')
            .style('font-weight', 'bold')
            .style('fill', d => d.count > 80 ? 'white' : 'black')
            .style('pointer-events', 'none');
        
        // X axis
        svg.append('g')
            .attr('class', 'axis')
            .attr('transform', `translate(0,${height})`)
            .call(d3.axisBottom(xScale))
            .selectAll('text')
            .style('font-size', '12px')
            .style('font-weight', 'bold')
            .attr('transform', 'rotate(-45)')
            .style('text-anchor', 'end');
        
        // Y axis
        svg.append('g')
            .attr('class', 'axis')
            .call(d3.axisLeft(yScale))
            .selectAll('text')
            .style('font-size', '14px')
            .style('font-weight', 'bold');
        
        // Axis labels
        svg.append('text')
            .attr('x', width / 2)
            .attr('y', height + 80)
            .attr('text-anchor', 'middle')
            .style('font-size', '15px')
            .style('font-weight', 'bold')
            .text('Prompt Length Category');
        
        svg.append('text')
            .attr('transform', 'rotate(-90)')
            .attr('x', -height / 2)
            .attr('y', -100)
            .attr('text-anchor', 'middle')
            .style('font-size', '15px')
            .style('font-weight', 'bold')
            .text('Sport');
        
        // Color legend
        const legendWidth = 300;
        const legendHeight = 20;
        
        const legendScale = d3.scaleLinear()
            .domain([0, d3.max(heatmapData, d => d.count)])
            .range([0, legendWidth]);
        
        const legendAxis = d3.axisBottom(legendScale)
            .ticks(5);
        
        const legend = svg.append('g')
            .attr('transform', `translate(${width / 2 - legendWidth / 2}, ${height + 100})`);
        
        // Create gradient
        const defs = svg.append('defs');
        const linearGradient = defs.append('linearGradient')
            .attr('id', 'legend-gradient');
        
        linearGradient.selectAll('stop')
            .data(d3.range(0, 1.1, 0.1))
            .enter().append('stop')
            .attr('offset', d => d)
            .attr('stop-color', d => colorScale(d * d3.max(heatmapData, dt => dt.count)));
        
        legend.append('rect')
            .attr('width', legendWidth)
            .attr('height', legendHeight)
            .style('fill', 'url(#legend-gradient)');
        
        legend.append('g')
            .attr('transform', `translate(0, ${legendHeight})`)
            .call(legendAxis);
        
        legend.append('text')
            .attr('x', legendWidth / 2)
            .attr('y', -5)
            .attr('text-anchor', 'middle')
            .style('font-size', '13px')
            .style('font-weight', 'bold')
            .text('Number of Prompts (Color Intensity)');
        
        // Add summary statistics
        const totalPrompts = d3.sum(heatmapData, d => d.count);
        svg.append('text')
            .attr('x', width / 2)
            .attr('y', -30)
            .attr('text-anchor', 'middle')
            .style('font-size', '12px')
            .style('fill', '#7f8c8d')
            .text(`Total Prompts Analyzed: ${totalPrompts}`);
    </script>
</body>
</html>
